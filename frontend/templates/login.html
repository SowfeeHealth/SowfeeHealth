{% load static %}
<!DOCTYPE html>
<html lang="en">
  <link rel="icon" type="image/x-icon" href="/images/sowfeefavicon.png" />

  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Sowfee Health - Login</title>
    <link
      rel="stylesheet"
      href= "{% static 'login.css' %}"
    />
  </head>

  <body>
    <div class="login-container">
      <div class="logo">Sowfee Health</div>

      <form id="loginForm" method="POST" action="/login/">
        {% csrf_token %}
        <!-- The hidden csrf token input is not needed, as {% csrf_token %} already inserts it -->

        <div class="form-group">
          <label for="email">Email</label>
          <input
            type="email"
            id="email"
            name="email"
            placeholder="Enter your institutional email"
            required
          />
        </div>

        <div class="form-group">
          <label for="password">Password</label>
          <input
            type="password"
            id="password"
            name="password"
            placeholder="Enter your password"
            required
          />
        </div>

        <button type="submit" class="login-btn">Sign In</button>
        <!-- ... rest of the form ... -->
      </form>

      <div style="display: flex; justify-content: center; align-items: center; height: 100px; text-align: center;">
        <a href="{% url 'register' %}" style="color: var(--primary); text-decoration: none; font-weight: 500;">
          No Account? Register Now!
        </a>
      </div>
      
      <!-- Modal for messages -->
      {% if messages %}
      <div id="messageModal" class="modal">
        <div class="modal-content">
          <span class="close-button">&times;</span>
          {% for message in messages %}
          <p
            style="
              {% if message.tags == 'success' %} color: #155724; {% else %} color: #721c24; {% endif %}"
          >
            {{ message }}
          </p>
          {% endfor %}
        </div>
      </div>
      {% endif %}

      <script>
        window.onload = function () {
          var modal = document.getElementById("messageModal");
          modal.style.display = "block";

          var closeButton = document.getElementsByClassName("close-button")[0];
          closeButton.onclick = function () {
            modal.style.display = "none";
            // Trigger the redirect after closing the modal
            window.location.href = "{{ index_url }}";  // Use the Django 'index' URL
          };

          window.onclick = function (event) {
            if (event.target == modal) {
              modal.style.display = "none";
              // Trigger the redirect after clicking outside the modal
              window.location.href = "{{ index_url }}";  // Use the Django 'index' URL
            }
          };
        };
      </script>
      
  </body>
</html>
